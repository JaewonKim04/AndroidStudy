# 딥링크 처리
- 딥링크: 사용자가 URL이나 알림과 같은 외부 소스에서 특정 화면이나 기능으로 이동할 수 있는 기능
## 1단계: 매니페스트에서 딥 링크 정의하기
- 딥 링크를 처리해야 하는 Activity에 대해 AndroidManifest에서 intent filter 선언
```xml
        <activity
            android:name=".main.CustomActivity"
            android:configChanges="colorMode"
            android:exported="true">
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
                <category android:name="android.intent.category.BROWSABLE" /> - URI를 통해 접근 가능
                
                <data
                    android:scheme="https"
                    android:host="example.com"
                    android:pathPrefix="/deelLink" />
            </intent-filter>
        </activity>
```
- scheme: URL 스키마 지정
- host: 도메인 지정
- pathPrefix: URL의 경로 정의 -
`"https://example.com/deepLink"` URL로 CustomActivity 열기 가능
## 2단계: Activity에서 딥 링크 처리하기
- Intent 데이터를 검색하고 적절한 화면으로 이동하거나 작업 수행
```kotlin
class CustomActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        val param = intent?.data
        if (param != null) {
            // 가져온 데이터를 통해 작업 처리
        }
        setContent {
            MainScreen()
        }
    }
}
```
## 3단계: 딥 링크 테스트하기
- adb 명령어를 통해 테스트 가능
```
adb shell am start -a android.intent.action.View
-d "https://example.com/deepLink?id=123
com.example.myapp
```
[sdk platform 다운로드](https://developer.android.com/tools/releases/platform-tools#downloads)

## 추가 고려 사항
- 커스텀 스키마 : 커스텀 스키마(myapp://)를 앱 내부 적으로 사용할 때 선호할 수 있지만 더 넓은 호환성을 위해 `https` 지행
- 내비게이션 : 딥 링크 데이터를 기반으로 앱 내 다른 Activity나 Fragment로 이동하기 위해 Intent 사용
- 폴백 처리 : 딥 링크 데이터가 유효하지 않거나 불완전한 경우 처리 필요
- App Link : 딥 링크가 브라우저 대신 앱에서 직접 열리게 하기 위하여 AppLink 설정 필요
```xml
<intent-filter android:autoVerify="true"> - autoVerify를 통해 기본 핸들러로 앱 자체를 지정 가능
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />

    <!-- Do not include other schemes. -->
    <data android:scheme="http" />
    <data android:scheme="https" />

    <data android:host="myownpersonaldomain.com" />
</intent-filter>

```
   - 앱이 설치되어 있는 경우 명확성 대화상자 없이 앱이 즉시 열림