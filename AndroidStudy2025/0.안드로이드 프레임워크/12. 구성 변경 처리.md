# 구성 변경(configuration changes)를 어떻게 처리할지
- 구성 변경 : 앱의 설정 (화면 회전, 언어 변경, 다크모드 전환, 글꼴 크기 조정 등)이 변경되는 상태
- 구성 변경이 발생하면 Activity를 다시 시작하기 때문에 UI 상태가 손실 될 수 있음
- 이에 따라 올바른 전략이 필요함
## 대응 방법
1. UI 상태 저장 & 복원
   - onSaveInstanceState(), onRestoreInstanceState()를 구현하여 Activity의 상태를 저장하는 방법
```kotlin
   class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            MainScreen()
        }
    }

    override fun onSaveInstanceState(outState: Bundle) {
        super.onSaveInstanceState(outState)
        outState.putAll(
            // 값 저장
        )
    }

    override fun onRestoreInstanceState(savedInstanceState: Bundle) {
        super.onRestoreInstanceState(savedInstanceState)
        savedInstanceState.get(
            // 값 복원
        )
    }
}
````
2. Jetpack ViewModel
   - Activity의 재시작 범위를 넘어서 존재하도록 설계되었기 때문에 구성 변경이 일어나도 ViewModel의 값은 보존됨
3. 구성 변경 수동으로 처리하기
   - AndroidManifest에 Activity가 다시 시작하지 않아도 되는 구성 변경을 선언할 수 있음
   ```xml
   <activity
    android:name=".MyActivity"
    android:configChanges="orientation|screenSize|screenLayout|keyboardHidden"
    android:label="@string/app_name">
    ```
    ```kotlin
    class MainActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContent {
            MainScreen()
        }
    }

    override fun onConfigurationChanged(newConfig: Configuration) {
        super.onConfigurationChanged(newConfig) // 구성 변경이 발생했을 때 커스텀 가능
    }
}
    ```
4. Jetpack Compose - rememberSaveable 활용
   - 구성 변경이 일어나도 값을 저장하고 있을 수 있는 Jetpack Compose의 함수

## 추가 팁
- 내비게이션 및 백 스택 보존 : Navigation 컴포넌트를 사용하면 구성 변경이 발생해도 백 스택 보존 가능
- 앱 구성에 의존적인 데이터 피하기 : 다크모드 여부, 폰트 사이즈 등의 데이터는 직접 저장 지양하기. 꼭 필요하다면 데이터를 보존 하도록 설계된 ViewModel 등의 대안 고려