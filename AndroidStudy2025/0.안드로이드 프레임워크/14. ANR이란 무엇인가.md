# ANR 이란
- 메인 스레드가 통상 5초 이상 차단될 때 발생
   - 시스템은 사용자에게 앱을 닫거나 기다리도록 안내
## 예방방법
### 무거운 작업을 메인 스레드 밖으로 이동
- 네트워크 요청 또는 데이터베이스 쿼리 같은 작업은 백그라운드 스레드, 코루틴(Dispatcher.IO) 등으로 이동
### WorkManager 사용
- WorkManager는 개발자가 필요한 작업을 스케쥴링하고 메인 스레드 외부에서 실행되도록 보장 (이후 챕터에서 자세히 살펴볼 예정)
### 데이터 불러오기 최적화
- 데이터를 작고 관리 가능한 형태로 가져와 UI 과부화 방지 (Paging 등 구현)
```json
{
    "list" : [
        {
            "data" : { ... }
        },
        {
            "data" : { ... }
        },
        {
            "data" : { ... }
        },
        {
            "data" : { ... }
        }
        ...
    ]
}

// Paging
{
    "page" : 1,
    "list" : [
        {
            "data" : { ... }
        },
        {
            "data" : { ... }
        },
    ]
}

{
    "page" : 2,
    "list" : [
        {
            "data" : { ... }
        },
        {
            "data" : { ... }
        },
    ]
}
```
### 구성 변경 시 UI 작업 최소화
- ViewModel을 활용하여 UI 관련 데이터를 유지, 구성 변경에 불필요한 UI 랜더링을 막기
### Android Studio로 모니터링 및 프로파일링
- CPU, 메모리 및 네트워크 사용량 모니터링 가능
### 블로킹 호출 피하기
- 메인 스레드에서 긴 루프, sleep 호출 또는 네트워크 요청을 동기로 수행하여 UI 스레드를 블로킹하는 작업 수행 X
```kotlin
try {
   sleep(1000)
} catch (e: InterruptedException) {
   e.printStackTrace()
}
```
### 가벼운 지연 작업에 Hndler 사용
```kotlin
Handler(WeakReference(mainLooper).get()!!).postDelayed(
   {
      // 1초 기다린 후 실행할 작업
   },
   1000,
)
            
```
- 스레드를 차단하지 않고 가벼운 지연 작업 처리 가능
