# 애플리케이션 용량 줄이기
- 저장 공간이 제한적이거나 인터넷 연결이 느린 유저에게 중요
- 기능과 동작을 손상시키지 않는 여러 전략 사용 가능
## 사용하지 않는 리소스 제거
- drawable 등 사용하지 않는 리소스는 APK 크기를 증가시킴
- build.gradle에 설정을 추가해 빌드 프로세스에서 자동으로 제거 가능
```
android {
    buildTypes {
        release {
            minifyEnabled true
            shrinkResources true // 사용하지 않는 리소스 자동 제거
        }
    }
}
```
## R8로 코드 축소 활성화 하기
- 사용되지 않는 클래스, 메서드를 제거
- 코드를 난독화하여 더욱 컴팩트하게 만듦
## 최적화된 리소스
- 벡터 드로어블
   - 래스터 이미지(PNG, JPEG) 대신 용량을 덜 차지하는 벡터 드로어블 사용
      - 레스터 이미지 : 이미지를 점으로 나누어 그 점의 색상등을 저장
      - 벡터 : 하나의 선이나 도형을 저장. 연속적인 함수로 표현
- 이미지 압축
   - TinyPNG, ImageMagick. 등의 도구를 사용하여 래스터 이미지를 압축
- WebP 사용
   - 웹 환경을 위해 만들어진 효율적인 이미지 포멧
## AAB 사용
- GooglePlay가 개별 기기에 맞는 최적화된 APK를 제공
```
android {
    bundle {
        language {
            enableSplit = true // 언어별 분할을 활성화합니다. (기본값)
        }
        density {
            enableSplit = true // 밀도별 분할을 활성화합니다. (기본값)
        }
        abi {
            enableSplit = true // ABI별 분할을 활성화합니다. (기본값)
        }
    }
}
```
## 불필요한 라이브러리 의존성 제거
- 사용되지 않거나 중복되는 라이브러리 제거
- Gradle Dependency Analyzer 를 사용해서 무거운 라이브러리 및 전이 의존성 식별 가능
   - `/gradlew <모듈명>:checkReleaseUnusedDependencies`

## 네이티브 라이브러리 최적화
- 네이티브 라이브러리가 포함된 경우 gradle 설정에서 최적화 가능
```
android {
    defaultConfig {
        ndk {
            abiFilters "armeabi-v7a", "arm64-v8a" // 필요한 ABI 만 포함
        }
    }
    packagingOptions {
        exclude "**/lib/**/*.so.debug" // 디버깅 심볼 제거
    }
}
```
   - 디버깅 심볼 : 기계어 주소를 사람이 읽을 수 있는 함수 이름으로 변환해주는 파일
      - 예: 크레시 리포트의 메모리 주소 (0x12345678) 를 실제 함수 이름 (MyNativeFunction()) 으로 변환

## Proguard 규칙을 구성하여 디버그 정보 줄이기
- proguard-rules.pro 파일에서 필요없는 정보 제거 설정
```
-dontwarn com.example.unusedlibrary.**
-keep class com.example.important.** { *; }
```
## 동적 기능(Dynamic Features) 사용
- 자주 사용되지 않는 기능을 Dynamic Feature 모듈로 분리
   - 필요한 경우 설치
```
android {
    dynamicFeatures = [":feature1", ":feature2"]
}
```
## 앱 내 대용량 에셋 피하기
- 크기가 큰 이미지 등은 CDN 활용
- 미디어 콘텐츠는 스트리밍 사용