# BroadcastReceiver란?
- 운영 체제의 메시지나 앱 특정 브로드캐스트를 수신할 수 있는 컴포넌트
   - 브로드캐스트 : 앱 시스템이나 다른 앱의 의해 트리거 됨
      - 배터리 상태, 네트워크 연결 업데이트, 앱 내에서 전송된 커스텀 Intent 등의 이벤트
## BroadcastReceiver의 목적
- 앱이 백그라운드에서 계속 실행되지 않아도 변경사항을 반영할 수 있도록 함
   - Activity나 Service의 생명주기에 연결되지 않을 수 있는 이벤트 처리
## Broadcast 유형
### 시스템 브로드캐스트
- 배터리 잔량 변경, 시간대 업데이트, 네트워크 연결 변경과 같은 시스템 이벤트
```kotlin
val batteryStatus: Intent? = IntentFilter(Intent.ACTION_BATTERY_CHANGED).let { ifilter ->
    context.registerReceiver(null, ifilter) // 배터리 확인 receiver 등록
}
```
### 커스텀 브로드캐스트
- 앱 내부 또는 앱 간에 특정 정보나 이벤트를 전달하기 위해 사용
```kotlin
val intent = Intent("com.example.snippets.ACTION_UPDATE_DATA").apply { // 커스텀 데이터 추가
    putExtra("com.example.snippets.DATA", newData)
    setPackage("com.example.snippets")
}
context.sendBroadcast(intent)
```
#### 커스텀 BroadcastReceiver 선언
```kotlin
class CustomBroadcastReceiver : BroadcastReceiver() {
    override fun onReceive(context: Context, intent: Intent) {
        val action = intent.action
        if (action = "com.example.snippets.ACTION_UPDATE_DATA") {
            // data 처리
        }
    }
}
```
#### 커스텀 BroadcastReceiver 등록
1. Manifest 사용 - 앱이 실행중이지 않을 때도 동작
```xml
<receiver android:name=".CustomBroadcastReceiver"
      android:exported="false">
      <intent-filter>
         <action android:name = "com.example.snippets.ACTION_UPDATE_DATA">
      </intent-filter>
</receiver>
```
2. 코드를 통한 동적 등록 - 앱이 실행 중이거나 특정 상태일 때 동작
```kotlin
val batteryStatus: Intent? = IntentFilter(Intent.ACTION_BATTERY_CHANGED).let { ifilter ->
    context.registerReceiver(null, ifilter) // 배터리 확인 receiver 등록
}

...

override fun onDestroy() {
    unregisterReceiver(receiver) // 동적 등록시 메모리 누수 방지를 위해 리시버 해지 필요
    super.onDestroy()
}
```
- 안드로이드 8.0 부터 백그라운드 앱은 브로드캐스트 수신에 제한을 받음 (Implicit broadcast exception 제외)
   - Context.registerReciver 또는 JobScheduler, workManager를 사용
- 민감한 정보가 포함된 브로드캐스트는 권한으로 보호해야함